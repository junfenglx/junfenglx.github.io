<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="author" content="junfeng" />
    <meta name="robots" content="index, follow"/>

    <meta property="og:title" content="word2vec train procedure explained"/>
    <meta property="og:url" content="http://junfenglx.github.io/word2vec-train-procedure-explained.html"/>
    <meta property="og:site_name" content="jf.h"/>
    <meta property="og:type" content="article"/>

    <link rel="canonical" href="http://junfenglx.github.io/word2vec-train-procedure-explained.html" />
    <link rel="shortcut icon" href="favicon.ico" />

    <title>word2vec train procedure explained | jf.h</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="http://junfenglx.github.io/theme/css/bootstrap-combined.min.css" type="text/css" />

    <link rel="stylesheet" href="http://junfenglx.github.io/theme/css/main.css" type="text/css" />
    <link href="http://junfenglx.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="jf.h Atom Feed" />

</head>

<body id="index">
    <div class="row-fluid">
        <div class="span10 offset1">
            <header id="banner" >
                <h1>
                    <a href="http://junfenglx.github.io/">jf.h
 <h3><strong>lylx</strong></h3>                    </a>
                </h1>
                <nav class="navbar">
                    <div class="navbar-inner">
                        <ul class="nav">
                            <li><a href="/">Home</a></li>
                            <li><a href="http://junfenglx.github.io/pages/about.html">About Me</a></li>
                        </ul>

                    </div>
                </nav>
            </header><!-- /#banner -->
        </div>
    </div>

    <div class="row-fluid">
        <div class="span10 offset1">
            <div class="row-fluid">
<div class="span10 offset1">
  <section>
    <article>
      <header>
        <h1 class="entry-title">
          <a href="http://junfenglx.github.io/word2vec-train-procedure-explained.html" rel="bookmark"
             title="Permalink to word2vec train procedure explained">word2vec train procedure explained</a></h1>
      </header>
      <div class="entry-content">
<footer class="post-info">
    <address class="vcard author">
        by <a class="url fn" href="http://junfenglx.github.io/author/junfeng.html">junfeng</a>
    </address>

    in <a href="http://junfenglx.github.io/category/machinelearning.html">machinelearning</a>

    on 2016-03-22

        |
        tags:         <a href="http://junfenglx.github.io/tag/word2vec.html">word2vec</a>
        <a href="http://junfenglx.github.io/tag/deeplearning.html">deeplearning</a>


        |
        <a href="http://junfenglx.github.io/word2vec-train-procedure-explained.html#disqus_thread">comments</a>

    
</footer><!-- /.post-info -->

        <style type="text/css">/*!
*
* IPython notebook
*
*/.ansibold{font-weight:700}.ansiblack{}.ansired{color:#8b0000}.ansigreen{6400}.ansiyellow{color:#c4a000}.ansiblue{8b}.ansipurple{color:#9400d3}.ansicyan{color:#4682b4}.ansigray{color:gray}.ansibgblack{background-}.ansibgred{background-color:red}.ansibggreen{background-color:green}.ansibgyellow{background-color:#ff0}.ansibgblue{background-f}.ansibgpurple{background-color:#ff00ff}.ansibgcyan{background-ff}.ansibggray{background-color:gray}div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;border-width:thin;border-style:solid;width:100%;padding:5px;margin:0;outline:0}div.cell.selected{border-color:#ababab}@media print{div.cell.selected{border-color:transparent}}.edit_mode div.cell.selected{border-color:green}.prompt{min-width:14ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}@-moz-document url-prefix(){div.inner_cell{overflow-x:hidden}}div.input_area{border:1px solid #cfcfcf;border-radius:2px;background:#f7f7f7;line-height:1.21429em}div.prompt:empty{padding-top:0;padding-bottom:0}div.unrecognized_cell{padding:5px 5px 5px 0;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.unrecognized_cell .inner_cell{border-radius:2px;padding:5px;font-weight:700;color:red;border:1px solid #cfcfcf;background:#eaeaea}div.unrecognized_cell .inner_cell a,div.unrecognized_cell .inner_cell a:hover{color:inherit;text-decoration:none}@media (max-width:540px){.prompt{text-align:left}div.unrecognized_cell>div.prompt{display:none}}div.code_cell{}div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.input{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.input_prompt{color:navy;border-top:1px solid transparent}div.input_area>div.highlight{margin:.4em;border:none;padding:0;background-color:transparent}div.input_area>div.highlight>pre{margin:0;border:none;padding:0;background-color:transparent}.CodeMirror{line-height:1.21429em;font-size:14px;height:auto;background:0 0}.CodeMirror-scroll{overflow-y:hidden;overflow-x:auto}.CodeMirror-lines{padding:.4em}.CodeMirror-linenumber{padding:0 8px 0 4px}.CodeMirror-gutters{border-bottom-left-radius:2px;border-top-left-radius:2px}.CodeMirror pre{padding:0;border:0;border-radius:0}.highlight-base,.highlight-variable{}.highlight-variable-2{color:#1a1a1a}.highlight-variable-3{color:#333}.highlight-string{color:#BA2121}.highlight-comment{color:#408080;font-style:italic}.highlight-number{80}.highlight-atom{color:#88F}.highlight-keyword{color:green;font-weight:700}.highlight-builtin{color:green}.highlight-error{color:red}.highlight-operator{color:#A2F;font-weight:700}.highlight-meta{color:#A2F}.highlight-def{f}.highlight-string-2{color:#f50}.highlight-qualifier{color:#555}.highlight-bracket{color:#997}.highlight-tag{color:#170}.highlight-attribute{c}.highlight-header{f}.highlight-quote{90}.highlight-link{c}.cm-s-ipython span.cm-keyword{color:green;font-weight:700}.cm-s-ipython span.cm-atom{color:#88F}.cm-s-ipython span.cm-number{80}.cm-s-ipython span.cm-def{f}.cm-s-ipython span.cm-variable{}.cm-s-ipython span.cm-operator{color:#A2F;font-weight:700}.cm-s-ipython span.cm-variable-2{color:#1a1a1a}.cm-s-ipython span.cm-variable-3{color:#333}.cm-s-ipython span.cm-comment{color:#408080;font-style:italic}.cm-s-ipython span.cm-string{color:#BA2121}.cm-s-ipython span.cm-string-2{color:#f50}.cm-s-ipython span.cm-meta{color:#A2F}.cm-s-ipython span.cm-qualifier{color:#555}.cm-s-ipython span.cm-builtin{color:green}.cm-s-ipython span.cm-bracket{color:#997}.cm-s-ipython span.cm-tag{color:#170}.cm-s-ipython span.cm-attribute{c}.cm-s-ipython span.cm-header{f}.cm-s-ipython span.cm-quote{90}.cm-s-ipython span.cm-link{c}.cm-s-ipython span.cm-error{color:red}.cm-s-ipython span.cm-tab{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=')right no-repeat}div.output_wrapper{display:-webkit-box;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;z-index:1}div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:2px;-webkit-box-shadow:inset 0 2px 8px rgba(0,0,0,.8);box-shadow:inset 0 2px 8px rgba(0,0,0,.8);display:block}div.output_collapsed{margin:0;padding:0;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.out_prompt_overlay{height:100%;padding:0 .4em;position:absolute;border-radius:2px}div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000;box-shadow:inset 0 0 1px #000;background:rgba(240,240,240,.5)}div.output_prompt{color:#8b0000}div.output_area{padding:0;page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.output_area .MathJax_Display{text-align:left!important}div.output_area div.output_area img,div.output_area svg{max-width:100%;height:auto}div.output_area img.unconfined,div.output_area svg.unconfined{max-width:none}.output{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}@media (max-width:540px){div.output_area{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.output_area pre{margin:0;padding:0;border:0;vertical-align:baseline;background-color:transparent;border-radius:0}div.output_subarea{overflow-x:auto;padding:.4em;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;max-width:calc(100% - 14ex)}div.output_text{text-align:left;line-height:1.21429em}div.output_stderr{background:#fdd}div.output_latex{text-align:left}div.output_javascript:empty{padding:0}.js-error{color:#8b0000}div.raw_input_container{font-family:monospace;padding-top:5px}span.raw_input_prompt{}input.raw_input{font-family:inherit;font-size:inherit;color:inherit;width:auto;vertical-align:baseline;padding:0 .25em;margin:0 .25em}input.raw_input:focus{box-shadow:none}p.p-space{margin-bottom:10px}div.output_unrecognized{padding:5px;font-weight:700;color:red}div.output_unrecognized a,div.output_unrecognized a:hover{color:inherit;text-decoration:none}.rendered_html{}.rendered_html :link,.rendered_html :visited,.rendered_html h1:first-child{margin-top:.538em}.rendered_html h2:first-child{margin-top:.636em}.rendered_html h3:first-child{margin-top:.777em}.rendered_html h4:first-child,.rendered_html h5:first-child,.rendered_html h6:first-child{margin-top:1em}.rendered_html *+ol,.rendered_html *+ul{margin-top:1em}.rendered_html *+table{margin-top:1em}.rendered_html *+p{margin-top:1em}.rendered_html *+img{margin-top:1em}div.text_cell{display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.text_cell>div.prompt{display:none}}div.text_cell_render{outline:0;resize:none;width:inherit;border-style:none;padding:.5em .5em .5em .4em;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}a.anchor-link:link{text-decoration:none;padding:0 20px;visibility:hidden}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible}.text_cell.rendered .input_area{display:none}.text_cell.rendered .text_cell.unrendered .text_cell_render{display:none}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6{font-weight:700;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cm-header-1{font-size:185.7%}.cm-header-2{font-size:157.1%}.cm-header-3{font-size:128.6%}.cm-header-4{font-size:110%}.cm-header-5,.cm-header-6{font-size:100%;font-style:italic}</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Abstract">Abstract<a class="anchor-link" href="#Abstract">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This article gives a detailed explanation of the weight vector updates in word2vec C implementation.</p>
<p>And find some not correct procedures that used train skip-gram model in the code.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Word2vec is a famous word embeddings approch. See detailed at <a href="https://en.wikipedia.org/wiki/Word2vec">Word2vec</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prerequisite">Prerequisite<a class="anchor-link" href="#Prerequisite">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="some-properties-of-sigmoid-function">some properties of sigmoid function<a class="anchor-link" href="#some-properties-of-sigmoid-function">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(0)</p>
$$
\sigma' (y) = \sigma (y) \cdot [ 1 - \sigma (y) ] \cdot y'
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="visualize-a-property-of-sigmoid-function">visualize a property of sigmoid function<a class="anchor-link" href="#visualize-a-property-of-sigmoid-function">¶</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
\frac {1} {N} \sum_{i=1}^{N} \sigma(x_i) \approx
\sigma( \frac {1} {N} \sum_{i=1}^{N} x_i )
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I can't prove it, my major is not math</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [70]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline --no-import-all

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">))</span>

<span class="n">m_s</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">m_x_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">m_x_s</span><span class="p">,</span> <span class="n">m_s</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m_x_s</span><span class="p">,</span> <span class="n">m_s</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Populating the interactive namespace from numpy and matplotlib
</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
hxTcRUTy0P8HnUuiSwUqMcwAAAAASUVORK5CYII=
">
</img></div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAEACAYAAAC+gnFaAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAIABJREFUeJzt3XeY1OX19/H3AWxg7LGACqJiwYqKKElYNVHwZ8AoFmKM
vQUssQRrXGOMYkxsqI9YMEQUIxhBEUTUtaIQkIgUIaIUQSyIiKAuu+f548y6wzJb2Ck7u/N5Xdde
fPt9L/CdM3c3d0dERApXs4bOgIiINCwFAhGRAqdAICJS4BQIREQKnAKBiEiBUyAQESlwdQoEZtbd
zGaZ2Wwz65/ifDczW2ZmUxI/1yad+72ZvWdm75rZUDNbP5O/gIiIpKfWQGBmzYCBwFFAR6CPme2e
4tJX3b1T4ufPiXtbAxcCndx9H6AFcHLGci8iImmrS4mgMzDH3ee5eykwDOiV4jqr5v7mQCszawG0
BBbVK6ciIpIVdQkEbYAFSfsLE8eqOsTMpprZaDPbE8DdFwF/A+YDHwPL3H18mnkWEZEMylRj8WRg
R3ffj6hGehrAzDYjSg9tgdbAxmb26wylKSIiGdCiDtd8DOyYtL994tgP3H1F0vYYM7vXzLYADgfm
uvtSADN7CjgUeKxqImamSY9ERNaRu1dXLV9ndSkRTAJ2MbO2iR4/JwOjki8ws22StjsDlvjwnw90
MbMNzcyAI4CZ1SXk7nn9c/311zd4HpRP5VP5VD4rfjKl1hKBu5eZWT9gHBE4HnL3mWZ2Xpz2QUBv
M7sAKAVWAScl7p1oZsOBdxLn3gEGZSz3IiKStrpUDeHuY4Hdqhy7P2n7HuCeau69AbghjTyKiEgW
aWTxOigqKmroLNSJ8plZymdmKZ/5xzJZz5QOM/N8yYuISGNgZniOGotFRAQoL4fbboNRo2q/tjGp
UxuBiEihW74cTjsNFixoeoFAJQIRkVrMmAGdO8MGG8Crr0Lr1g2do8xSIBARqcGIEdClC5xyCjz+
OLRs2dA5yjxVDYmIpFBWBtdcA3ffDUOGwPHHN3SOskeBQESkis8/hz59YNYseP112H//hs5Rdqlq
SEQkyZQpcOCBsGIFTJrU9IMAKBCIiPzgH/+Arl3hZz+Dl1+Gbbdt6BzlhgKBiBS877+Hvn3hjDPg
hhsiIGy4YUPnKnfURiAiBW3RIujdG6ZNg6efhp49GzpHuadAICIF6/XX4YQT4tv/m2/C3ns3dI4a
hqqGRKTguEe30MMOg113hYkTCzcIgAKBiBSYlStjqoiLLoo/x4+HH/+4oXPVsFQ1JCIF48MP4bjj
4N134Y47IhhY2nN3Nn4KBCJSEJ5/PgaJlZXB6NHQvXtD5yh/qGpIRPJaaSl8+WX973eHv/wFevSA
LbeEt95SEKhKgUBE8tbnn8P660O3bvW7f/nyqAq65ppoGH77bdhjj8zmsSmoUyAws+5mNsvMZptZ
/xTnu5nZMjObkvi5Nuncpmb2pJnNNLPpZnZwJn8BEWmaPvywshH37bfX/f6ZM2Pq6Kefht/9DsaO
hS22yGwem4pa2wjMrBkwEDgCWARMMrOR7j6ryqWvunuqoRh3As+5+wlm1gJogpO4ikgmvfMOdOoU
26tXQ/Pma19TWgrrrVe5/9138Oc/w9lnw+TJ0SNo1Sq4554IBFK9upQIOgNz3H2eu5cCw4BeKa5b
q+3dzDYBfurugwHcfbW7L08nwyLStI0fH0Fgo41iachUQeDJJ2H77ePDH2Dx4qj6eest+PvfY8ro
9daDceMUBOqiLoGgDbAgaX9h4lhVh5jZVDMbbWZ7Jo7tBHxuZoMTVUaDzGyjNPMsIk3U0KHwi1/E
9tKla3ftLC+H4mI49VS47rpYNvLNN+GAA2DrraNH0F13wW67RXXS4Yfn/FdolDLVfXQysKO7rzSz
HsDTQIfE8zsBfd39P2Z2B3AlcH2qhxQXF/+wXVRURFFRUYayJyL57rbb4IorYnvkyLUnffvmm6ju
GTkSevWCCy+EFi2gWbPoETR1KsybB0cdBcOGwWab5f53yLaSkhJKSkoy/lxz95ovMOsCFLt798T+
lYC7+4Aa7vkQOABYD5jg7u0Tx38C9Hf3X6a4x2vLi4g0TRddFFM+ADzzDBxzzJrnFyyIyeDefTc+
4JcujeMtWsRU0QsXxv7vfw+33hrHC4GZ4e5pD4mry1/XJGAXM2sLLAZOBvpUycw27r4ksd2ZCDBL
E/sLzKyDu88mGpxnpJtpEWk6evaMD3+AZ5+F//u/Nc9PmAC/+hUsWRL7FUFggw2ijaAiCDz4IJx1
Vm7y3NTUGgjcvczM+gHjiDaFh9x9ppmdF6d9ENDbzC4ASoFVwElJj7gIGGpm6wFzgTMy/UuISOPj
Hn36338/9p97Lqp4kg0ZAuecE+sFVFXRUAzwyiuxmIzUT61VQ7miqiGRwlG1N9CYMWuO9i0rg6uu
ivmASktrftbcubDTTtnJZ77LVNWQRhaLSE6Vlq4ZBJ5/fs0gsHx5NAaPGlVzEOjUKa4t1CCQSQoE
IpIz33wTU0ZUGDcOjjyycn/uXDjkkOgxVFFllEq/frGGwI9+lL28FhIFAhHJic8+g403rtx/4YXK
MQMQi8UfemisGDZiRPXPGTw4ehilGmgm9VMgnaxEpCHNnQs771y5P348HHFE5f7998Mf/whXXw2X
XFL9cyZMgC5dspfPQqXGYhHJquR5g5o3j5LAYYfFfmlp9P1/8cWYF2jevOqfM28e7Lhj9vPbmORy
HIGISL2MH19Z/bPBBjEDaMWEAUuXwoknwkcfwQcfVP+M9u1jIFmrVtnObeFSG4GIZMVjj1UGgZYt
YxbQ/faL/Zdegn33jZJATUHgzDNhzhwFgWxTIBCRjLvtNjjllNhu1SpmAL300vjQP/HEaB+oGBFc
nQcfhIceirmEJLtUNSQiGdWvX3z7h+gl1KNHTA19//1w4IF1e8Zbb8HBWsIqZ9RYLCIZ4R4zf77w
Quy3bBlTSEyeHFU8Dz9ct+d8/DG0bp363MyZsHJlTDstGlksInmkvBx22KEyCEB8YE+eHNt1DQKz
ZqUOAuXlcPvt0LVrLEIjmaWqIRFJS2npmqOF6+t//1tzrEGF+fPh9NPh00/htdegY8f005I1qUQg
IvW2cmVmgsAXX6wdBNzh0Udhn31g111jSgkFgexQiUBE6uXLL2GLLdJ7Rrt2UR20wQZrHv/iCzj/
/JiLaNAgOOmklLdLhigQiMg6W7QI2qRauXwdrLdeTD1RdV3isWOjcblNmxiV3L59eulI7VQ1JCLr
ZPbs9IMARANychD45psYb9CjB5x8MrzxhoJArqhEICJ1NnFiZvr3/+c/a3YBffttOPXUmHYi1ZrF
kl0qEYhInYwenX4QaN8+PuwrgkBpKVx/fXQL3W47mDpVQaAhKBCISK0eeCD9D+hLLol5gzbfPPZn
zYr1B268Ea65JuYd2n779PMq665OgcDMupvZLDObbWb9U5zvZmbLzGxK4ufaKuebJY6PylTGRSQ3
rrkGzj03vWeMHh0Dwpo1i8FhAwfC/vvHfEPjx8MNN0ALVVQ3mFr/6s2sGTAQOAJYBEwys5HuPqvK
pa+6e89qHnMxMAPYJJ3MikhunXgiPPlkes9YuDAal5csgdWr4YwzYgTyUUfBkCGw9daZyavUX11i
cGdgjrvPAzCzYUAvoGogSDnfhZltDxwN3ARcWv+sikiuuMNee8GMGek9p7QUPvxwzd5BLVrArbfC
ZZdpZtF8UZd/hjbAgqT9hYljVR1iZlPNbLSZ7Zl0/HbgCkAzyok0AqtXxwd0OkHgjDNixbHu3aFD
h8rj7drFNBFXXKEgkE8yVSs3GdjR3VeaWQ/gaaCDmR0DLHH3qWZWRDWlhgrFxcU/bBcVFVFUsZSR
iOTEqlUxa2g6HngADjkENtpozePHHx9rDGy2WXrPL2QlJSWUlJRk/Lm1TkNtZl2AYnfvnti/EnB3
H1DDPXOBA4HLgd8Aq4GNgB8BT7n7b1Pco2moRRrQpEnQuXN6zxg1KtYS+Mtf1jx+770xZUTVUcSS
nkxNQ12XQNAceJ9oLF4MTAT6uPvMpGu2cfclie3OwL/cvV2V53QDLquuQVmBQKRhfPZZjOgdPjy9
50yfvvakcLvtBk88EctSSublbPF6dy8zs37AOKJN4SF3n2lm58VpHwT0NrMLgFJgFaApokTy3KpV
cOedcNVV6T/riSfWDgKnnRbdRDfeOP3nS3ZphTKRAlNeHtM7X3stfPttlAjSsc020TU02ZAhMWWE
ZJdWKBORdfbii7Fu8H33wdFHpxcETj89/kwOAh07xohhBYHGRSUCkQLw3nvwhz/A++/DLbfEEpID
qu3uUbvttlt7yci+feG222DDDdPLq9SdSgQiUqvFi+Gcc+Dww2Mk78yZsdBLOkGg4rnJRoyI9gAF
gcZJs3uINEErVsS387vvhrPOijUENtssVgL7/vvMpbPnnjGPULt2mXum5J5KBCJNyOrV8Y2/Q4dY
DH7KlJjOYdNNow9/JoPAH/4Q00YrCDR+KhGINAHu8Nxz8eG89dYxsOvAA+NcaWlmFphPNnZsVDVJ
06BAINLITZkCl18e9fa33hrrBlSM4M3EaOFku+4Kr7wSjcXSdKhqSKSRmj8/umkecwycdBL885/Q
qlUEgfnzY76fTAaBa6+NxmYFgaZHgUCkEXGPfvr9+8fCLjvtBH/+c1T/dOsWK4Bdcgm0bRtz/mTK
q6/GSmLNm2fumZI/NI5ApJH4/vvo9QPRA+j882NMQDa1bg3vvgtbbpnddKR+NI5ApEC4x4RwFUEA
YOed1w4CmZ7Zs39/uO466N0bysoy+2zJLwoEInlswgTo2hVOOKHy2K23xsjgZM8/HwEjk4YOjbEI
116rKqGmTlVDInnq2Wfhl79c89jmm8OXX+Ym/auvjiBQdYEZyR85W48gVxQIRNb07beVH8K5DAAH
HxyrjO29d27Sk/pTG4FIE3fXXZXbuQoC99wDb76pIFBoFAhE8tDDD0dj7a675ia9Y4+FhQtjpTIt
Kl94VDUkkmdGjYJevXKX3siR0DPlArKS71Q1JNIEvfJK7oJA376wfLmCgKhEIJI3Jk+unCgu295+
O7PTT0jDyGmJwMy6m9ksM5ttZv1TnO9mZsvMbEri59rE8e3N7CUzm25m08zsonQzLNIUTZ+emyBw
000xQllBQJLVOvuomTUDBgJHAIuASWY20t1nVbn0VXevWshcDVzq7lPNbGNgspmNS3GvSMGaORP2
2iv76XzwAbRvn/10pPGpS4mgMzDH3ee5eykwDEhVi7lW8cTdP3H3qYntFcBMoE0a+RVpUiZNilW+
sun226G8XEFAqleX9QjaAAuS9hcSwaGqQ8xsKvAxcIW7z0g+aWbtgP2At+uVU5Em5qmn4Pjjs5vG
Z5/BVltlNw1p/DK1MM1kYEd3X2lmPYCngQ4VJxPVQsOBixMlg5SKi4t/2C4qKqKoqChD2RPJLzfe
CH/8Y/aef9pp8Mgj2Xu+NIySkhJKSkoy/txaew2ZWReg2N27J/avBNzdB9Rwz4fAAe6+1MxaAM8C
Y9z9zhruUa8hafLKy+Hoo2OSuGyZORN23z17z5f8kaleQ3UpEUwCdjGztsBi4GSgT5XMbOPuSxLb
nYkAszRx+mFgRk1BQKQQLF8eq3utXJm9NFatgg03zN7zpWmqtbHY3cuAfsA4YDowzN1nmtl5ZnZu
4rLeZvaemb0D3AGcBGBmXYFTgMPN7J1E19LuWflNRPLY++/DpptmLwgMGBDTUCsISH1oQJlIlmV7
yohJk3I3EE3yi6aYEMlz5eVQXJzdIPDZZwoCkr5M9RoSkYTycliyJGb0nDgxe+msXq2VwyQzFAhE
Mui772D//aPnTjZ99ZWCgGSOqoZEMmTFimiszWYQOOWUKHFsskn20pDCo0AgkgFffAE/+lF207ji
Cnj0UbC0mwZF1qRAIJKmWbNyM43DV19lPw0pTAoEImkYPRr22CP76dxxB/y//5f9dKQwKRCI1NON
N8Ixx2Q3jdat4Y034OKLVSUk2aNeQyLrqKwMuneH8eOzm063bvCvf8HWW2c3HREFApF1sHQptGkD
336b/bT22ktBQHJDVUMidfTuu7DllrkJApddBn//e/bTEQGVCETqZNgw6NOn9usyYexYOOqo3KQl
AioRiNRo9erov5+LIHDYYTE1hYKA5JpKBCLV+OIL6N0bsrAg1Fpuvx0uugia6auZNAAFApEqysvh
rbega9fcpDdlSsxPJNJQFAhEqsjVZG69e8e6wq1a5SY9keqoICpClAKeey53g7aeeAKefFJBQPKD
SgRS0JYvj2/lxcXw5Ze5SfOjj6Bt29ykJVIXWqpSClZ5ObRvDwsXxmjhbDvsMBg3Dlro65dkSE6X
qjSz7mY2y8xmm1n/FOe7mdmyxOL0U8zs2rreK9JQmjWDTp1yEwT69oWXXlIQkPxU639LM2sGDASO
ABYBk8xspLvPqnLpq+7es573iuRUaWlM5Pbvf2c/rdNPh4EDs5+OSH3V5ftJZ2COu88DMLNhQC+g
6od5quJJXe8VyYr334/VvLbbrvLYkiVw4onw6qvZTXvvveG//81uGiKZUJeqoTbAgqT9hYljVR1i
ZlPNbLSZ7bmO94pknDvsvjs88EDlsYkT4aCDsh8Errkm5iYy0/TRkv8yVWM5GdjR3VeaWQ/gaaDD
uj6kuLj4h+2ioiKKiooylD0pRIcfHn9edVX8+fDDcMkl8PXX2U134MBoExDJtJKSEkqyMNS91l5D
ZtYFKHb37on9KwF39wE13PMhcAARDOp0r3oNSSYNHgxnngkdO8bI3Usugfvuy03a+m8suZKpXkN1
KRFMAnYxs7bAYuBkYI0puMxsG3dfktjuTASYpWZW670imTZuXAQBiIVdDj88VvnKBa0rLI1RrYHA
3cvMrB8wjmhTeMjdZ5rZeXHaBwG9zewCoBRYBZxU071Z+l1EmDoVjj++cr+oCD77LPvpbr01LF6s
SeOkcdKAMmkyFiyALl1g0aLKYxdeCHffnd10DzkEXn4ZNtggu+mIVJWpqiEFAmkSli2Dn/wEZszI
bR19p04RBDbZJHdpilTI6chikXz2/fdw3HEwfXplELj22prvSdedd8Iuu8REdQoC0tipRCCNmjv8
9rfw6KO5SW/99eG77yLd1athvfVyk65IKioRiADXXZe7IHDqqREEIAaJKQhIU6FAII3WwIFw002x
ve222U3rxhthyJDspiHSUFQ1JI3SAw/AuefmJq0HH4SzzspNWiLrQlVDUrBuvjl3QWDECAUBafo0
O7o0Gu7xoTx4cG7SGzMGunfPTVoiDUmBQBqFVavgpz+FyZNzk96LL1ZOWifS1CkQSN6bPz+mk161
KjfplZRAt265SUskH6iNQPLayy/HQu+5CgKvvaYgIIVHgUDykjvccUduq2fefDOmqRApNKoakryz
cmX0Cho6NHdpTpgQE9aJFCIFAskrH30Us3l+8knu0vz3vxUEpLApEEjeeOEFOPLI3KY5ZQrsv39u
0xTJN2ojkAbnDmefnfsg8MgjCgIioCkmpIF9+SVssUXu091tN5g1K/fpimSSppiQRu/mm7MfBM45
J5aRrGr48OymK9KYqI1Acm7ePGjXLvvp/O53MTjs3nuhd29o3Ro6dozgs9de2U9fpLGoU4nAzLqb
2Swzm21m/Wu47iAzKzWz45KO/d7M3jOzd81sqJmtn4mMS+Pz7bfRIygXQeD442PFsmeegcsug+23
jwnkJkyA4uLspy/SmNQaCMysGTAQOAroCPQxs92rue4W4PmkY62BC4FO7r4PUQI5OTNZl8airAz+
8hfYaCN4663sp9e1aywaM3YsXHJJNEa/8gqMGwe/+lVMVyEilepSIugMzHH3ee5eCgwDeqW47kJg
OPBplePNgVZm1gJoCSxKI7/SCPXpA9dck5u0dtsNDj00BqP94x8wbVoEgfbt4Wc/gwEDcpMPkcak
Lm0EbYAFSfsLieDwg8Q3/2Pd/TAz++Gcuy8ys78B84GVwDh3H59+tqWxmDMHnnwyN2ltuy306xc/
ENNFvPFGtA0AFBXlJh8ijU2mGovvAJLbDgzAzDYjSg9tga+A4Wb2a3d/LNVDipMqb4uKiijSm9uo
zZ0LHTpkN43NNoNly2JR+XvvjaqfCh07ZjdtkVwrKSmhpKQk48+tdRyBmXUBit29e2L/SsDdfUDS
NXMrNoGtgG+Ac4H1gaPc/ZzEdacCB7t7vxTpaBxBE/Lf/8J++8X2j38Mn32W+TQWL4Z334VTToFR
o6IhWqSQZGocQV1KBJOAXcysLbCYaOztk3yBu7dPythg4Bl3H5WoJupiZhsC3wFHJJ4nTdi990Lf
vpX72QgCq1dD8+ZRHbRoUTQOi0j91NpY7O5lQD9gHDAdGObuM83sPDNLtXKsJ907kWhAfgf4L1Fi
GJSJjEv+KSuDPfdcMwhk2qmnRi+g5s0rjykIiKRHU0xIRsydCzvvnN00HnkETjstu2mINCaaYkLy
gjv8/e/ZDwKTJysIiGSLppiQeisvhz32gNmzs5vOggUxMlhEskOBQOpt5MjsB4GlS2HzzbObhkih
U9WQrLPycrjuuuxX1Xz9tYKASC6oRCDrZNmy6Lf/3HPZTWfFCmjVKrtpiEhQIJA6mz4devWCDz7I
bjpffaUgIJJLqhqSOhkxIubwz3YQ+OIL2GST7KYhImtSIJAalZXB1VfHwi7Z9sknDbNspUihU9WQ
VGvpUujRAyZOzH5aCxbANttkPx0RWZsCgaT07ruw777ZT6dlS3jvPY0TEGlIqhqStTzySG6CwL33
wpQpsNNO2U9LRKqnEoH8YPVqOPJIePnl7KbTsmV0D7W0Z0gRkUxQiUAA+PTTmMUz20Gga1f45hsF
AZF8okAgDB+em4ba886D11/Pfjoism5UNVTA3GH//WM1sWy77Ta47LLspyMi606BoEAtXAg77JCb
tEaMgOOOy01aIrLuVDVUgO69N3dBYMIEBQGRfKcSQQH56ivYbLPcpfe//2V/wRoRSZ9KBAXilVdy
GwQ+/VRBQKSxqFMgMLPuZjbLzGabWf8arjvIzErN7LikY5ua2ZNmNtPMppvZwZnIuNTNd99Bz55Q
VJS7NL/+Gn7849ylJyLpqbVqyMyaAQOBI4BFwCQzG+nus1JcdwvwfJVH3Ak85+4nmFkLoGVGci61
ytU0Ecm+/RY22CC3aYpIeupSIugMzHH3ee5eCgwDeqW47kJgOPBpxQEz2wT4qbsPBnD31e6+PP1s
S03KyuCvf819EFi9WkFApDGqSyBoAyxI2l+YOPYDM2sNHOvu9wHJY0Z3Aj43s8FmNsXMBpnZRulm
Wqr30Udw+OHwhz+sfe7oo7OT5o47xvKVzZtn5/kikl2Z6jV0B5Cq7aAF0Ano6+7/MbM7gCuB61M9
pLi4+IftoqIiinJZsd3IucOQIXDxxdE7KNmDD8LZZ2dneclf/ALGjcv8c0VkbSUlJZSUlGT8uebu
NV9g1gUodvfuif0rAXf3AUnXzK3YBLYCvgHOBd4GJrh7+8R1PwH6u/svU6TjteVFUvv885i+4bXX
4LPP1jzXoQPMnp2ddM89F+6/PzvPFpHamRnunvbMXXWpGpoE7GJmbc1sfeBkYFTyBe7ePvGzE9FO
8Dt3H+XuS4AFZtYhcekRwIx0My2VRo+GffaJ7ppVgwBkLwjccIOCgEhTUWvVkLuXmVk/YBwROB5y
95lmdl6c9kFVb6myfxEw1MzWA+YCZ2Qg3wVvxQq4/HIYOxYOOwwee6zyXMeO0WA8a1b196fjvvvg
/POz82wRyb1aq4ZyRVVDdffWW3DqqXDggTB9OkybFsdbtowSwtCh0S6QCXvsATNnVu4//jicfHJm
ni0i6cll1ZDkidJS+OMf4dhj4fTTYdiwyiDw0ksxz/8112QuCPz612sGgeeeUxAQaYpUImgkZs2C
3/wGmjWLaqGKD+iOHWPN37IyaJHBmaN69IAxYyr3X3sNfvKTzD1fRNKXqRKBAkGeKy+He+6JcQHN
m8e3/gqjR8fYgGxPKf3OO7Dfftl7vojUj6qGCsDHH0P37nDRRVEtlBwEvvgigsDgwZkJAgccAL9c
q1MvvP++goBIU6dAkKeeeAL23hsmTYIzz4yqH4gGYnfYfHNo3z7Opevf/4Y33oBnnlnz+EcfxTgE
EWnatB5BHhoyBK64Avr3h+23j7YBgEcfhVNOgeXLYdNN6//8Zs2iygmi11HbtnDQQWtes3gxbLtt
/dMQkcZDJYI8dNJJMH8+bLxxZRBYuDCCwBtvpBcE/vSnyiBwwAHR6+iooyp7H0EMTFMQECkcKhHk
ofJyuOCCaKT94IOoAiovj66bTzxRv2futhu0axfdTyGqly69dO3uoEuXRrWTiBQO9RrKM/Pnxxq/
u+4a4wFatYJFi6BNm9rvrc6tt1bORrrHHjBjRuqeRsuWpVfaEJHcUq+hJqikBA4+GPr0iSkjWrWC
hx9OLwg8+mhlELjssggCc+bEmIA99ojSxoMPwsqVCgIihUpVQ3nAHe66C26+OT64f/7zWOlrk02i
22h9PfFEtDcA/OtfcMIJ0Rbwi1/A7rtHbyFVA4mIAkEDW7kyppB+772YQ6hdO5g6Ffbfv/7P3Hff
mCK6IghMmRLPe+utGHtw1FHwyCNaTUxEggJBA/roo2gP2HPP6A200UbRS2jo0Po976qrolF52TLo
2zeOffwxtG4dcxH17BnHb745upCKiIACQYN58cXoDnrllbGq2LJl0SZQX9OmxXiAPn1i6gmIOYla
tYKRI2MCuVtvrQwQIiIV9L0wx9zhb3+Lb/6PPw6XXBIlgC22qP8zV6yIap4uXWCzzaJbaFlZBIGh
Q2PK6sceUxAQkdRUIsihb76JtYPnzIG3347eQM2aRXCoq622iqUpAXr3jkbgMWNiWuo//SnaGyzR
meyhh2Ja6hdeiN5IIiKpqESQI3PnwqGHwvrrx5TOK1bEtNHrEgQuvLAyCAweHEHg5pvhnHOiB9D5
51cGAYi0hLvLAAAL2klEQVTZSl9/XUFARGqmAWU5MG5cVM9cd11Uz5x6amWD8Kabwldf1f6M666D
G2+M7bffjjEAp58ejcEjRqQ31kBEGqecDigzs+5mNsvMZptZ/xquO8jMSs3suCrHm5nZFDMbVd29
TZE7DBgQH9hPPglnnBFVQcm9guoSBHr2rAwC06ZF3/8uXaJd4ZVXFAREJD21BgIzawYMBI4COgJ9
zGz3aq67BXg+xWMuBmakl9XGZcWK6Mc/YgRMnFg5iRzAPvvUfv+VV0JxcWyPSoTPSZNgwQLo2jWq
iQYN0lgAEUlfXRqLOwNz3H0egJkNA3oBs6pcdyEwHFhjQmMz2x44GrgJuDTdDDcG//sf/OpX0Lkz
vPpqjA+oUFQUU0nUZMqUqOtPHlT20ktRxTRwIDz1lJaNFJHMqUvVUBtgQdL+wsSxH5hZa+BYd78P
qFpfdTtwBdA0GwCqGDMmvrH37QuXX14ZBPbcM6pwagoCvXrFeIJx4yqDwKabRjfTe+6JksGkSQoC
IpJZmeo1dAewVtuBmf0fsMTdpxIBIu1GjXzlDjfdFN1Dn3oqvsHvuWec+93vYrK3jz9Ofe+ll8Jz
z0U10oEHRrXQz38egePSS+HPf47xAWoPEJFsqEvV0MfAjkn72yeOJTsQGGZmBmwF9DCz1UAXoKeZ
HQ1sBPzIzIa4+29TJVRcUSkOFBUVUVRUVMdfo2F9/XU0CC9aFB/Wu+5aea5nT7j33urvnTAhGn4/
+SS6k0J0Db3xxlg4ZuBAuOGGtbuGikjhKSkpoaS2uuV6qLX7qJk1B94HjgAWAxOBPu4+s5rrBwPP
uPtTVY53Ay5z957V3Ncou4/Ong3HHgs//WlU51xwQRy/5pqYSXTevMprt9suloCs8PXX0YA8alRU
C0EsFn/ccbFeQMuWMVZAVUEikkrOuo+6exnQDxgHTAeGuftMMzvPzM5NdUu6mWosnn02PqQvuSR6
8FQEgb/9De6+e82SwQEHVAaB44+PyeEqlqLs1Qs6dYqupL/5TawjvNtu0dtIQUBEsk0DyuqhvDzq
7QcNiqUfzzsvjl98Mfz1r1FNtOGGUcWz7bbR33/69LhmxIj4xr9qVXzjhwgaZ58dU0S//DKceWY0
Dm+4YYP8eiLSSGSqRKC5htbR8uXw29/GVA9bb10ZBObPj6Ufv/su+vY//DAccghMnlxZEqi4Ztq0
yrEEM2bALrvEojGvvRYB4IIL1B4gIrmjuYbWwaxZMTagdetYP+Cdd+Ibv3t8wH/6afT2GTo0poOe
MAG+/x722itWHNthh6g2qggC330XVUBnnhnXvvRS9DBSEBCRXFIgqKORI+FnP4OzzoqGXIh5/yu+
7U+bFkFiyZKY+//xx+P4gAFxbv3140P/8stj9TD3ODZjRvQ2mjw5GpxFRHJNbQS1KC+PqR4eeSQG
id19dywoc+ON8UEO0evnlFNiLeCvv4bx4+N4RdfQTz+FbbaJY88/D0ce2RC/iYg0NZlqI1AgqMGy
ZdGLZ+nSmO1z7NhoAK74IHePVb9uuimCxKBBcW3LljHt9DbbRKnhmGPi+s8/hy23bLjfR0SalpzO
PlqIZsyIqh6zqOdftCjaBJK/zX/4YYwIvuwyuOWWCAKnnx4BZJtt4LTTIgjsv3+ULBQERCQfKRCk
8NRTMTnczjvDW29Ftc/o0dFLKFmbNrD33rE4DMCQIVFiKC+PADJkSIwMrphETkQkH6n7aJKyshgX
cP/98SE/d27U6XfqtPa18+dHl89ly2KhmH33jePvvRfBAWDmTNh9rQm7RUTyi0oECV9+GdU499wT
3+gPOCB68qQKAhXBoUOHuKYiCNx+e2UQ+O47BQERaRwUCIjunQcdFB/wzZrFJHEPP1y5kEyF8vKY
AK537xhBPGRI5TXnnhszhZ5zTmXXUBGRxqDgew3961+xhOTKldHV87HHYKed1r7u88+jB9HChXFP
xRTTFcaMgfXWiwFlIiK5oF5DaSorg/79YznJVavg6qtjNbFUQWDixKgq2mGH2K4aBAB69FAQEJHG
qSAbi7/4IqaAeOGFmC7in/+Eww9Pfe0//hHdQ++6K0YMi4g0NQUXCP7731hP+MMP4Ze/jLaArbaq
+Z4334yGYRGRpqig2ggefzzmCiovh9tui9HA6t8vIo2V2gjWwerVMdnbr38N7dpFPX+/fgoCIiJQ
AFVDn38eDcIvvRRdPG+/vXJBGBERaeKBYMqUaA9YvhyefDL6/4uIyJqabNXQP/8JXbvCjjtGA7GC
gIhIanUKBGbW3cxmmdlsM+tfw3UHmVmpmR2X2N/ezF4ys+lmNs3MLspUxqtTWhqLyZ9+eowTePnl
CAYiIpJarYHAzJoBA4GjgI5AHzNbaxadxHW3AM8nHV4NXOruHYFDgL6p7s2UTz+NxWGeegpKSmJB
mRYZrPwqKSnJ3MOySPnMLOUzs5TP/FOXEkFnYI67z3P3UmAY0CvFdRcCw4FPKw64+yfuPjWxvQKY
CbRJO9cp/Oc/Mfp3yy1h6tTsLPvYWP5jKJ+ZpXxmlvKZf+oSCNoAC5L2F1Llw9zMWgPHuvt9QMpO
mWbWDtgPeLs+Ga3Js8/GgjHXXgvDh8MWW2Q6BRGRpitTFSd3AMltB2sEAzPbmCgtXJwoGWRUmzbw
xhuxnKSIiKybWkcWm1kXoNjduyf2rwTc3QckXTO3YhPYCvgGONfdR5lZC+BZYIy731lDOvkxxFlE
pBHJyeL1ZtYceB84AlgMTAT6uPvMaq4fDDzj7k8l9ocAn7v7pelmVkREMq/WNgJ3LwP6AeOA6cAw
d59pZueZ2bmpbqnYMLOuwCnA4Wb2jplNMbPuGcq7iIhkQN5MOiciIg0j6yOLG8tgtPrmM+l4s0SJ
Z1S+5tPMNjWzJ81sZuLv9eA8zefvzew9M3vXzIaaWVYW/qwtj2bWzcyWJf5dp5jZtXW9Nx/ymW/v
UE1/n4nzefEO1fLvnjfvUC35XLd3yN2z9kMEmv8BbYH1gKnA7tVc9yLRqHxc4ti2wH6J7Y2Jdoq1
7m3ofCad+z3wKDAqH/8+E8cfAc5IbLcANsm3fAKtgbnA+on9J4DfNkQegW6p/j3r+vvlQT7z6h2q
Lp9J5/PiHaopn/n0DtXw777O71C2SwSNYjBaOvmE+OYFHA08mKX8pZ1PM9sE+Km7DwZw99Xuvjzf
8pnQHGiV6HHWEljUgHlM1SOjrvc2aD7z9B2qbpxRvr1Da+UzT9+h6noMrdM7lO1AkPeD0RLSzeft
wBUkNZRnSTr53An43MwGJ4qRg8xso3zLp7svAv4GzAc+Bpa5+/iGyGPCIWY21cxGm1nFatV1vTcT
0snnD/LhHUqoLp958w4lpMpnXr1D1eWzPu9QPsw+2qCD0dZB1XwCYGb/ByxJfPMyqo/QuZIyn0Qx
thNwj7t3AlYCV+YyY1Wk/Hc3s82Ibz5tiSLuxmbWUKtFTwZ2dPf9iPm2nm6gfNSmxnzm0TuUMp9m
dgz59Q5V9/eZb+9QdX+f6/wOZTsQfAwkz/25feJYsgOBYWb2IdAbuMfMegIkijXDgX+6+8g8y+e9
iXx2BXpaDKp7HDjMYuxEvuVzIbDA3f+TuG448Z86X/JZ8e/+c2Cuuy/16Lr8FHBoQ+TR3Ve4+8rE
9hhgPTPboi735kk+8+odSpHPFol8HkoevUM1/H3m1TtUQz7X/R3KRkNHUqNFcyobPNYnGjz2qOH6
wazZuDkE+Hs285iJfCYdr7ExrKHzCbwCdEhsXw8MyLd8EnWj04ANiW+GjwB9GyKPwDZJ252Bj+rz
+zVUPhP7efMO1ZTPpOMN/g7V8veZN+9QDf8/1/kdyuoKZe5eZmYVg9GaAQ95YjBanPZBVW+p2LDK
wWjTzOydxLmr3X1sPuUzlzKQz4uAoWa2HtGr4Ix8y6e7TzSz4cA7QGniz6rX5yqPvc3sgkQ+VgEn
1XRvpvOYbj7z8B1Kmc9cykA+8+kdqu7/5zq/QxpQJiJS4PKhsVhERBqQAoGISIFTIBARKXAKBCIi
BU6BQESkwCkQiIgUOAUCEZECp0AgIlLg/j+2wt/T7E01lgAAAABJRU5ErkJggg==
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="hierarchical-softmax">hierarchical softmax<a class="anchor-link" href="#hierarchical-softmax">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(1)
$$ p(w | w_I) = \prod_{j=1}^{L(w)-1} \sigma \left( [\![ n(w, j+1) = ch(n(w, j)) ]\!] \cdot {v'_{n(w, j)}}^T v_{w_I} 
\right) $$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="the-hierarchical-softmax-gradient">the hierarchical softmax gradient<a class="anchor-link" href="#the-hierarchical-softmax-gradient">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First let</p>
$$
hs_j = [\![ n(w, j+1) = ch(n(w, j)) ]\!] \cdot {v'_{n(w, j)}}^T v_{w_I}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And</p>
$$
\frac {d hs_j} {v'_{n(w, j)}} = [\![ n(w, j+1) = ch(n(w, j)) ]\!] \cdot v_{w_I}
$$$$
\frac {d hs_j} {v_{w_I}} = [\![ n(w, j+1) = ch(n(w, j)) ]\!] \cdot v'_{n(w, j)}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then
$$
\nabla \log p(w | w_I) = \sum_{j=1}^{L(w)-1} \frac{1} {\sigma (hs_j)} \cdot \sigma' (hs_j) \cdot hs'_j
$$</p>
<p>According to equation (0)
$$
\nabla \log p(w | w_I) = \sum_{j=1}^{L(w)-1}
\frac{1} {\sigma (hs_j)}
\cdot
\sigma (hs_j) \cdot [ 1 - \sigma (hs_j) ]
\cdot
hs'_j
$$</p>
<p>simplify
$$
\nabla \log p(w | w_I) = \sum_{j=1}^{L(w)-1}
[ 1 - \sigma (hs_j) ] \cdot hs'_j
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v_{w_I} $, we got gradient is:</p>
$$
\nabla \log p(w | w_I) = \sum_{j=1}^{L(w)-1}
[ 1 - \sigma (hs_j) ] \cdot
[\![ n(w, j+1) = ch(n(w, j)) ]\!]
\cdot v'_{n(w, j)}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v'_{n(w, j)}$ for each $j \in [1, L(w)-1]$, we got gradient is:</p>
$$
\nabla \log p(w | w_I) = [ 1 - \sigma (hs_j) ]
\cdot
[\![ n(w, j+1) = ch(n(w, j)) ]\!]
\cdot
v_{w_I}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="negative-sampling">negative sampling<a class="anchor-link" href="#negative-sampling">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(2)
$$
\log p(w_O | w_I) = \log \sigma( {v'_{w_O}}^T v_{w_I} ) + 
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
\log \sigma( {-v'_{w_i}}^T v_{w_I} )
\right]
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="the-negative-sampling-gradient">the negative sampling gradient<a class="anchor-link" href="#the-negative-sampling-gradient">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First let</p>
$$
ns_{xI} = {v'_{w_x}}^T \cdot v_{w_I}
$$<p>$w_x \in \{ w_O, w_i \sim P_n(w) \}$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And</p>
<p>the gradients $ns_{xI}$ according to ${v'_{w_x}}$ and $v_{w_I}$ are:</p>
$$
\frac {d ns_{xI}} {v'_{w_x}} = v_{w_I}
$$$$
\frac {d ns_{xI}} {v_{w_I}} = v'_{w_x}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then</p>
$$
\nabla \log p(w_O | w_I) = \frac {1} { \sigma(ns_{OI}) }
\cdot
\sigma'(ns_{OI})
\cdot
ns'_{OI}
+
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
\frac {1} { \sigma(-ns_{iI}) } \cdot
\sigma'( -ns_{iI} ) \cdot
-ns'_{iI}
\right]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>According to equation (0)</p>
$$
\nabla \log p(w_O | w_I) = \frac {1} { \sigma(ns_{OI}) }
\cdot
\sigma(ns_{OI}) \cdot [ 1 - \sigma(ns_{OI}) ]
\cdot
ns'_{OI}
+
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
\frac {1} { \sigma(-ns_{iI}) } \cdot
\sigma ( -ns_{iI} ) \cdot
[ 1 - \sigma(-ns_{iI}) ] \cdot
-ns'_{iI}
\right]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>simplify</p>
$$
\nabla \log p(w_O | w_I) = [ 1 - \sigma(ns_{OI}) ] \cdot ns'_{OI}
+
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
[ 1 - \sigma(-ns_{iI}) ] \cdot
-ns'_{iI}
\right]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v'_{w_O} $, we got gradient is:</p>
$$
\nabla \log p(w_O | w_I) = [ 1 - \sigma(ns_{OI}) ] \cdot v_{w_I}
$$<p>When update $ v_{w_I} $, we got gradient is:</p>
$$
\nabla \log p(w_O | w_I) = [ 1 - \sigma(ns_{OI}) ] \cdot v'_{w_O}
+
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
[ 1 - \sigma(-ns_{iI}) ] \cdot
-v'_{w_i}
\right]
$$<p>When update $ v'_{w_i}, w_i \sim P_n{w} $, we got gradient is:</p>
$$
\nabla \log p(w_O | w_I) = [ 1 - \sigma(-ns_{iI}) ] \cdot -v_{w_I}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="continuous-bag-of-words">continuous bag of words<a class="anchor-link" href="#continuous-bag-of-words">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">c</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">"./cbow.png"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>
<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,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
AAAAAElFTkSuQmCC
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="maximize-the-following-average-log-probability:">maximize the following average log probability:<a class="anchor-link" href="#maximize-the-following-average-log-probability:">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(3)
$$ \frac{1}{T} \sum_{t=1}^{T} \sum_{-c \leq{j} \leq{c},j\neq{0}} \log{p(w_t | w_{t+j})} $$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I change the index $j$ to index $q$ due to conflict with index $j$ in hierarchical softmax.</p>
<p>(3)
$$ \frac{1}{T} \sum_{t=1}^{T} \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} $$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And</p>
$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} = \sum_{-c \leq{q} \leq{c},q\neq{0}}
\nabla \log{p(w_t | w_{t+q})}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="First-compute-the-mean-of-window-wods-vector">First compute the mean of window wods vector<a class="anchor-link" href="#First-compute-the-mean-of-window-wods-vector">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let 
$$
v_{mcw} = \frac{1}  {cw}
\sum_{-c \leq{q} \leq{c},q\neq{0}}
v_{w_{t+q}}
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="c1">// window word count</span>
      <span class="n">cw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span> <span class="n">a</span><span class="o">++</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="n">window</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// sentence_position is sp</span>
        <span class="c1">// c in [sp - (window - b), sp + (window - b)]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">sentence_position</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="c1">// may be is break?</span>
        <span class="c1">// because c is increase</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">sentence_length</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="n">last_word</span> <span class="o">=</span> <span class="n">sen</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">last_word</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="c1">// sum window words' vectors</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">syn0</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">last_word</span> <span class="o">*</span> <span class="n">layer1_size</span><span class="p">];</span>
        <span class="n">cw</span><span class="o">++</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">cw</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">/=</span> <span class="n">cw</span><span class="p">;</span>
        <span class="c1">// ...</span>
</pre></div>
<p><em><code>"neu1"</code> is $v_{mcw}$</em></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="when-using-hierarchical-softmax">when using hierarchical softmax<a class="anchor-link" href="#when-using-hierarchical-softmax">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$w_t$ is $w$, $w_{t+q}$ is $w_I$ in equation(1)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And</p>
$$
hs_j = [\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!] \cdot {v'_{n(w_t, j)}}^T v_{w_{t+q}}
$$<p>$q \in [-c, c], q\neq{0}$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then</p>
<p>When update $ v_{w_{t+q}}$ for each $q \in [-c, c], q\neq{0}$, we got gradient is:</p>
$$
\nabla \log p(w_t | w_{t+q}) = \sum_{j=1}^{L(w_t)-1}
[ 1 - \sigma (hs_j) ] \cdot
[\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!]
\cdot v'_{n(w_t, j)}
$$$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} =
\nabla \log p(w_t | w_{t+q})
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v'_{n(w_t, j)}$ for each $j \in [1, L(w_t)-1]$, we got gradient is:</p>
$$
\nabla \log p(w_t | w_{t+q}) = [ 1 - \sigma (hs_j) ]
\cdot
[\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!]
\cdot
v_{w_{t+q}}
$$$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} = \sum_{-c \leq{q} \leq{c},q\neq{0}}
[ 1 - \sigma (hs_j) ]
\cdot
[\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!]
\cdot
v_{w_{t+q}}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">hs</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="n">codelen</span><span class="p">;</span> <span class="n">d</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="n">l2</span> <span class="o">=</span> <span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="n">point</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">layer1_size</span><span class="p">;</span>
          <span class="c1">// l2 is index j in equation</span>

          <span class="c1">// Propagate hidden -&gt; output</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">f</span> <span class="o">+=</span> <span class="n">neu1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="c1">// f is +- hs_j</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
          <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
          <span class="c1">// approximation</span>
          <span class="c1">// may be round is better</span>
          <span class="k">else</span> <span class="n">f</span> <span class="o">=</span> <span class="n">expTable</span><span class="p">[(</span><span class="kt">int</span><span class="p">)((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))];</span>
          <span class="c1">// 'g' is the gradient multiplied by the learning rate</span>
          <span class="c1">// why sub code[d]?</span>
          <span class="c1">// another sigmoid property</span>
          <span class="c1">// \sigma(x) = 1 - \sigma(-x)</span>
          <span class="c1">// code[d] is 0 or 1</span>
          <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="n">code</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="c1">// Propagate errors output -&gt; hidden</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="c1">// Learn weights hidden -&gt; output</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">neu1</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the code We can see that, she or he uses $v_{mcw}$ in place of $v_{w_{t+q}}$</p>
$$
hs_j = [\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!] \cdot {v'_{n(w_t, j)}}^T v_{mcw}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>"syn1[l2]"</code> is $v'_{n(w_t, j)}$, then <code>"f"</code> in the above code before <code>"expTable"</code>
is $\pm hs_j$.</p>
<p>And $[ 1 - \sigma (hs_j) ] \cdot
[\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!]$ is <code>"1 - vocab[word].code[d] - f"</code> after <code>"expTable"</code>, because of the equation:</p>
$$
\sigma(x) = 1 - \sigma(-x)
$$<p>So <code>"vocab[word].code[d] == 0"</code> for $[\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!] = +1$,</p>
<p>and <code>"vocab[word].code[d] == 1"</code> for $[\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!] = -1$,</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
</pre></div>
<p>caculates the gradient of $ v_{w_{t+q}} $ for each $q \in [-c, c], q\neq{0}$</p>
<p>After <code>for loop "neu1e"</code> is the added weight vector for each $v_{w_{t+q}}$.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And the gradient of $ v'_{n(w_t, j)}$ for each $j \in [1, L(w_t)-1]$ is caculated as:</p>
$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} = cw \cdot
[ 1 - \sigma (hs_j) ]
\cdot
[\![ n(w_t, j+1) = ch(n(w_t, j)) ]\!]
\cdot
v_{mcw}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code doesn't multiply cw.</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">neu1</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
</pre></div>
<p>update the $v'_{n(w_t, j)}$ weight vector.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="when-using-negative-sampling">when using negative sampling<a class="anchor-link" href="#when-using-negative-sampling">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$w_t is\, w_O$, $w_{t+q} is\, w_I$ in equation(2)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And</p>
$$
ns_{x(t+q)} = {v'_{w_x}}^T \cdot v_{w_{t+q}}
$$<p>$w_x \in \{ w_t, w_i \sim P_n(w) \}$, $q \in [-c, c], q\neq{0}$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then</p>
<p>When update $ v'_{w_t} $, we got gradient is:</p>
$$
\nabla \log p(w_t | w_{t+q}) = [ 1 - \sigma(ns_{t(t+q)}) ] \cdot v_{w_{t+q}}
$$$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} = \sum_{-c \leq{q} \leq{c},q\neq{0}}
[ 1 - \sigma(ns_{t(t+q)}) ] \cdot v_{w_{t+q}}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v'_{w_i}, w_i \sim P_n{w} $, we got gradient is:</p>
$$
\nabla \log p(w_t | w_{t+q}) = [ 1 - \sigma(-ns_{i(t+q)}) ] \cdot -v_{w_{t+q}}
$$$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} = \sum_{-c \leq{q} \leq{c},q\neq{0}}
[ 1 - \sigma(-ns_{i(t+q)}) ] \cdot -v_{w_{t+q}}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v_{w_{t+q}} $ for each $q \in [-c, c], q\neq{0}$, we got gradient is:</p>
$$
\nabla \log p(w_t | w_{t+q}) = [ 1 - \sigma(ns_{t(t+q)}) ] \cdot v'_{w_t}
+
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
[ 1 - \sigma(-ns_{i(t+q)}) ] \cdot
-v'_{w_i}
\right]
$$$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} =
\nabla \log p(w_t | w_{t+q})
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">negative</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">negative</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">d</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// target is w_O, w_i</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">word</span><span class="p">;</span>
            <span class="n">label</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// random sample negative weight vector</span>
            <span class="n">next_random</span> <span class="o">=</span> <span class="n">next_random</span> <span class="o">*</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="mi">25214903917</span> <span class="o">+</span> <span class="mi">11</span><span class="p">;</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_size</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">target</span> <span class="o">=</span> <span class="n">next_random</span> <span class="o">%</span> <span class="p">(</span><span class="n">vocab_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">==</span> <span class="n">word</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">label</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="n">l2</span> <span class="o">=</span> <span class="n">target</span> <span class="o">*</span> <span class="n">layer1_size</span><span class="p">;</span>
          <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="c1">// caculate ns</span>
          <span class="c1">// syn1neg[l2] is v', neu1 is v_mcw</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">f</span> <span class="o">+=</span> <span class="n">neu1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="c1">// caculate gradient</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">MAX_EXP</span><span class="p">)</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="c1">// \sigma(x) = 1 - \sigma(-x), and 0 label for -ns</span>
          <span class="k">else</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">expTable</span><span class="p">[(</span><span class="kt">int</span><span class="p">)((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))])</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="c1">// neu1e is added weight vector for each w_{t+q}</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="c1">// update v'</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">neu1</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code uses $v_{mcw}$ in place of $v_{w_{t+q}}$</p>
$$
ns_{x(t+q)} = {v'_{w_x}}^T \cdot v_{mcw}
$$<p>$w_x \in \{ w_t, w_i \sim P_n(w) \}$, $q \in [-c, c], q\neq{0}$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>the gradient of ${v'_{w_x}},\, w_x \in \{ w_t, w_i \sim P_n(w) \}$ is caculated as:</p>
$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} = cw \cdot
[ 1 - \sigma(\pm ns_{x(mcw)} ) ]
\cdot
\pm v_{w_{mcw}}
$$<p>The code doesn't multiply <code>"cw"</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because the equation $ \sigma(x) = 1 - \sigma(-x)$,</p>
<p>the gradient of ${v'_{w_x}},\, w_x \in \{ w_t, w_i \sim P_n(w) \}$ is caculated as:</p>
$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log{p(w_t | w_{t+q})} =
  \begin{cases}
    - \sigma( ns_{x(mcw)} ) \cdot v_{w_{mcw}}       &amp; \quad \text{if } -ns_{x(mcw)} \\
    [ 1 - \sigma(ns_{x(mcw)} ) ] \cdot v_{w_{mcw}}  &amp; \quad \text{if } ns_{x(mcw)} \\
  \end{cases}
$$<p>The code above uses <code>"label = 0"</code> to caculate the gradient of $v'_{w_t}$,
<code>"label = 1"</code> to caculate the gradient of $v'_{w_i}$,</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The gradient of $ v_{w_{t+q}} $ is caculated as:</p>
$$
\nabla \sum_{-c \leq{q} \leq{c},q\neq{0}} \log p(w_t | w_{t+q}) =
[ 1 - \sigma(ns_{x(mcw)} ) ] \cdot v_{w_{mcw}}
+
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
- \sigma( ns_{x(mcw)} ) \cdot v_{w_{mcw}}
\right]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
</pre></div>
<p>caculates the gradient of $ v_{w_{t+q}} $ for each $q \in [-c, c], q\neq{0}$</p>
<p>After <code>for loop "neu1e"</code> is the added weight vector for each $v_{w_{t+q}}$.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="finally-updates-$-v_{w_{t+q}}-$-for-each-$q-\in-[-c,-c],-q\neq{0}$">finally updates $ v_{w_{t+q}} $ for each $q \in [-c, c], q\neq{0}$<a class="anchor-link" href="#finally-updates-$-v_{w_{t+q}}-$-for-each-$q-\in-[-c,-c],-q\neq{0}$">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="c1">// hidden -&gt; in</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span> <span class="n">a</span><span class="o">++</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="n">window</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">c</span> <span class="o">=</span> <span class="n">sentence_position</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="n">a</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">sentence_length</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
          <span class="n">last_word</span> <span class="o">=</span> <span class="n">sen</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">last_word</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">syn0</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">last_word</span> <span class="o">*</span> <span class="n">layer1_size</span><span class="p">]</span> <span class="o">+=</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the code above we can see that when updates each $v_{w_{t+q}}$, it uses the same vector <code>"neu1e"</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="skip-gram">skip-gram<a class="anchor-link" href="#skip-gram">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>

<span class="n">Image</span><span class="p">(</span><span class="s2">"./skip-gram.png"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[10]:</div>
<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="maximize-the-following-average-log-probability:">maximize the following average log probability:<a class="anchor-link" href="#maximize-the-following-average-log-probability:">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(4)
$$ \frac{1}{T} \sum_{t=1}^{T} \sum_{-c \leq{j} \leq{c},j\neq{0}} \log{p(w_{t+j} | w_t)} $$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same reason, I change the index $j$ to index $q$ due to conflict with index $j$ in hierarchical softmax.</p>
<p>(4)
$$ \frac{1}{T} \sum_{t=1}^{T} \sum_{-c \leq{q} \leq{c}, q\neq{0}} \log{p(w_{t+q} | w_t)} $$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The most difference between skip-gram and continuous bag of words in the code is
that when train skip-gram, updates the weight vectors for every window word.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Actually, these equations exchange $w_{t+q}$ with $w_t$,</em>
<em>and don't use $\sum_{-c \leq{q} \leq{c}, q\neq{0}} \log{p(w_{t+q} | w_t)}$ as "y"</em></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="when-using-hierarchical-softmax">when using hierarchical softmax<a class="anchor-link" href="#when-using-hierarchical-softmax">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$w_{t+q}$ is $w$, $w_{t}$ is $w_I$ in equation(1)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And</p>
$$
hs_j = [\![ n(w_{t+q}, j+1) = ch(n(w_{t+q}, j)) ]\!] \cdot {v'_{n(w_{t+q}, j)}}^T v_{w_t}
$$<p>$q \in [-c, c], q\neq{0}$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then</p>
<p>When update $ v_{w_t}$, we got gradient is:</p>
$$
\nabla \log p(w_{t+q} | w_t) = \sum_{j=1}^{L(w_{t+q})-1}
[ 1 - \sigma (hs_j) ] \cdot
[\![ n(w_{t+q}, j+1) = ch(n(w_{t+q}, j)) ]\!]
\cdot v'_{n(w_{t+q}, j)}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v'_{n(w_{t+q}, j)}$ for each $j \in [1, L(w_{t+q})-1]$, we got gradient is:</p>
$$
\nabla \log p(w_{t+q} | w_t) = [ 1 - \sigma (hs_j) ]
\cdot
[\![ n(w_{t+q}, j+1) = ch(n(w_{t+q}, j)) ]\!]
\cdot
v_{w_t}
$$<p>$q \in [-c, c], q\neq{0}$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="But,-the-code-actually-uses-cbow-model">But, the code actually uses cbow model<a class="anchor-link" href="#But,-the-code-actually-uses-cbow-model">¶</a></h5><p>The word2vec C implementation doesn't use these gradients of skip-gram.</p>
<p>Tt actually uses continuous bag of words model, when you require that
train using skip-gram.</p>
<p>I don't know why.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">hs</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="n">codelen</span><span class="p">;</span> <span class="n">d</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="n">l2</span> <span class="o">=</span> <span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="n">point</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">layer1_size</span><span class="p">;</span>
          <span class="c1">// Propagate hidden -&gt; output</span>
          <span class="c1">// l1 is w_{t+q}, l2 is n(w_t, j)</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">f</span> <span class="o">+=</span> <span class="n">syn0</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l1</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
          <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
          <span class="k">else</span> <span class="n">f</span> <span class="o">=</span> <span class="n">expTable</span><span class="p">[(</span><span class="kt">int</span><span class="p">)((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))];</span>
          <span class="c1">// 'g' is the gradient multiplied by the learning rate</span>
          <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="n">code</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="c1">// Propagate errors output -&gt; hidden</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="c1">// Learn weights hidden -&gt; output</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">syn1</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn0</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l1</span><span class="p">];</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code in the above is same as train continuous bag of words model, except that it replaces
<code>"neu1[c]"</code>  with <code>"syn0[c + l1]"</code>.</p>
<p>The gradients used are hierarchical softmax of CBOW, so actually train cbow model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="when-using-negative-sampling">when using negative sampling<a class="anchor-link" href="#when-using-negative-sampling">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$w_{t+q} is\, w_O$, $w_t is\, w_I$ in equation(2)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And</p>
$$
ns_{xt} = {v'_{w_x}}^T \cdot v_{w_t}
$$<p>$w_x \in \{ w_{t+q}, w_i \sim P_n(w) \}$, $q \in [-c, c], q\neq{0}$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then</p>
<p>When update $ v'_{w_{t+q}}$ for each $q \in [-c, c], q\neq{0}$, we got gradient is:</p>
$$
\nabla \log p(w_{t+q} | w_t) = [ 1 - \sigma(ns_{(t+q)t}) ] \cdot v_{w_t}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v'_{w_i}, w_i \sim P_n{w} $, we got gradient is:</p>
$$
\nabla \log p(w_{t+q} | w_t) = [ 1 - \sigma(-ns_{it}) ] \cdot -v_{w_t}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When update $ v_{w_t}$ we got gradient is:</p>
$$
\nabla \log p(w_{t+q} | w_t) = [ 1 - \sigma(ns_{(t+q)t}) ] \cdot v'_{w_{t+q}}
+
\sum_{i}^{k} E_{w_i \sim P_n(w)}
\left[
[ 1 - \sigma(-ns_{it}) ] \cdot
-v'_{w_i}
\right]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="But,-the-code-again-uses-cbow-model">But, the code again uses cbow model<a class="anchor-link" href="#But,-the-code-again-uses-cbow-model">¶</a></h5><p>The word2vec C implementation doesn't use these negative sample gradients of skip-gram.</p>
<p>Tt actually uses continuous bag of words model, when you require that
train using skip-gram.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">negative</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">negative</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">d</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">word</span><span class="p">;</span>
            <span class="c1">// should target = last_word;</span>
            <span class="n">label</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">next_random</span> <span class="o">=</span> <span class="n">next_random</span> <span class="o">*</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="mi">25214903917</span> <span class="o">+</span> <span class="mi">11</span><span class="p">;</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_size</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">target</span> <span class="o">=</span> <span class="n">next_random</span> <span class="o">%</span> <span class="p">(</span><span class="n">vocab_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">==</span> <span class="n">word</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">label</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="n">l2</span> <span class="o">=</span> <span class="n">target</span> <span class="o">*</span> <span class="n">layer1_size</span><span class="p">;</span>
          <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="c1">// l1 is w_{t+q}, l2 is in [w_t, w_i \sim P_n(w)]</span>
          <span class="c1">// l1 should be w_t</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">f</span> <span class="o">+=</span> <span class="n">syn0</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l1</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&gt;</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">MAX_EXP</span><span class="p">)</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="k">else</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">expTable</span><span class="p">[(</span><span class="kt">int</span><span class="p">)((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))])</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">;</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">];</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn0</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l1</span><span class="p">];</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again the code in the above is same as train continuous bag of words model, except that it replaces
<code>"neu1[c]"</code>  with <code>"syn0[c + l1]"</code>.</p>
<p>The gradients used are hierarchical softmax of CBOW, so actually train cbow model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="finally-updates-$-v_{w_{t+q}}-$-for-each-$q-\in-[-c,-c],-q\neq{0}$">finally updates $ v_{w_{t+q}} $ for each $q \in [-c, c], q\neq{0}$<a class="anchor-link" href="#finally-updates-$-v_{w_{t+q}}-$-for-each-$q-\in-[-c,-c],-q\neq{0}$">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">layer1_size</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span> <span class="n">syn0</span><span class="p">[</span><span class="n">c</span> <span class="o">+</span> <span class="n">l1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">neu1e</span><span class="p">[</span><span class="n">c</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>But it should update $v_{w_t}$</em></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Implementation">Implementation<a class="anchor-link" href="#Implementation">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>famous implementations have:</p>
<ul>
<li><a href="https://code.google.com/p/word2vec/">C</a></li>
<li><a href="http://radimrehurek.com/gensim/">Python</a></li>
<li><a href="http://deeplearning4j.org/word2vec.html">Java/Scala</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Future-works">Future works<a class="anchor-link" href="#Future-works">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I plan to implement a C++ version word2vec using correct gradients in recent weeks.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Word2vec is a powerful way to model languages.</p>
<p>But the original C implemetation doesn't use correct gradients for skip-gram model,
neither does Gensim.</p>
<p>I have not watch the word2vec implementation of Deeplearning4j,
so I can't give a conclusion.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="References">References<a class="anchor-link" href="#References">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some papers:</p>
<ol>
<li>Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean. 
 Efficient Estimation of Word Representations in Vector Space. In Proceedings of Workshop at ICLR, 2013.</li>
<li>Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg Corrado, and Jeffrey Dean.
 Distributed Representations of Words and Phrases and their Compositionality. In Proceedings of NIPS, 2013.</li>
</ol>
<p>Other useful urls:</p>
<ol>
<li><a href="http://arxiv.org/abs/1411.2738">Another word2vec parameter learning explanation</a>(not read)</li>
<li><a href="https://github.com/junfenglx/word2vec">My fork of C word2vec implementation</a></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>


      </div><!-- /.entry-content -->
      <div class="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_identifier = "word2vec-train-procedure-explained.html";
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//junfeng.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      </div>

    </article>
  </section>
</div>
            </div>
        </div>
    </div>

    <footer id="site-footer">
        <div class="row-fluid">
            <div class="span10 offset1">
                <address>
                    <p>
                        UI Designed By <a href="http://github.com/jsliang/pelican-fresh/">Fresh</a>
                    </p>
                </address>
            </div>
        </div>
    </footer>

<script type="text/javascript">
    var disqus_shortname = 'junfeng';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
    <script src="http://junfenglx.github.io/theme/js/jquery.min.js"></script>
    <script src="http://junfenglx.github.io/theme/js/bootstrap.min.js"></script>
    <script src="http://junfenglx.github.io/theme/js/jquery.cookie.js"></script>
    <!--script src="http://junfenglx.github.io/theme/js/analyse.js"></script -->
</body>
</html>